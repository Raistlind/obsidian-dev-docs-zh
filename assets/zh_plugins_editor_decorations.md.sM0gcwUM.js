import{_ as s,c as i,o as a,V as n}from"./chunks/framework.qP9-rlTe.js";const l="/obsidian-dev-docs-zh/assets/decorations.945n-hNJ.svg",y=JSON.parse('{"title":"è£…é¥°","description":"","frontmatter":{},"headers":[],"relativePath":"zh/plugins/editor/decorations.md","filePath":"zh/plugins/editor/decorations.md","lastUpdated":1705556984000}'),p={name:"zh/plugins/editor/decorations.md"},e=n('<h1 id="è£…é¥°" tabindex="-1">è£…é¥° <a class="header-anchor" href="#è£…é¥°" aria-label="Permalink to &quot;è£…é¥°&quot;">â€‹</a></h1><hr><p>è£…é¥°å¯ä»¥è®©ä½ æ§åˆ¶<a href="./editor-extensions.html">ç¼–è¾‘å™¨æ‰©å±•</a>ä¸­å†…å®¹çš„ç»˜åˆ¶æˆ–æ ·å¼ã€‚å¦‚æœä½ æƒ³é€šè¿‡æ·»åŠ ã€æ›¿æ¢ç¼–è¾‘å™¨ä¸­çš„å…ƒç´ æˆ–ä¸ºå…¶è®¾è®¡æ ·å¼æ¥æ”¹å˜ç¼–è¾‘å™¨çš„å¤–è§‚å’Œè§‚æ„Ÿï¼Œé‚£ä¹ˆä½ å¾ˆå¯èƒ½éœ€è¦ä½¿ç”¨è£…é¥°ã€‚</p><p>åœ¨æœ¬èŠ‚ç»“æŸæ—¶ï¼Œæ‚¨å°†èƒ½å¤Ÿï¼š</p><ul><li>äº†è§£å¦‚ä½•ä½¿ç”¨è£…é¥°æ¥æ”¹å˜ç¼–è¾‘å™¨å¤–è§‚ã€‚</li><li>äº†è§£ä½¿ç”¨çŠ¶æ€å­—æ®µå’Œè§†å›¾æ’ä»¶æä¾›è£…é¥°çš„åŒºåˆ«ã€‚</li></ul><blockquote><p>[!NOTE]</p><p>æœ¬é¡µæ—¨åœ¨ä¸ºObsidian æ’ä»¶å¼€å‘äººå‘˜æç‚¼ CodeMirror 6 å®˜æ–¹æ–‡æ¡£ã€‚æœ‰å…³çŠ¶æ€å­—æ®µçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…Â <a href="https://codemirror.net/docs/guide/#decorating-the-document" target="_blank" rel="noreferrer">Decorating the Document</a> ã€‚</p></blockquote><h2 id="å…ˆå†³æ¡ä»¶" tabindex="-1">å…ˆå†³æ¡ä»¶ <a class="header-anchor" href="#å…ˆå†³æ¡ä»¶" aria-label="Permalink to &quot;å…ˆå†³æ¡ä»¶&quot;">â€‹</a></h2><ul><li>å¯¹<a href="./state-fields.html">çŠ¶æ€å­—æ®µ</a>æœ‰åŸºæœ¬äº†è§£ã€‚</li><li>å¯¹<a href="./view-plugins.html">è§†å›¾æ’ä»¶</a>æœ‰åŸºæœ¬äº†è§£ã€‚</li></ul><h2 id="æ¦‚è¿°" tabindex="-1">æ¦‚è¿° <a class="header-anchor" href="#æ¦‚è¿°" aria-label="Permalink to &quot;æ¦‚è¿°&quot;">â€‹</a></h2><p>å¦‚æœæ²¡æœ‰è£…é¥°ï¼Œæ–‡æ¡£å°†æ˜¾ç¤ºä¸ºçº¯æ–‡æœ¬ï¼Œè¿™æœ‰äº›æ²¡è¶£ã€‚ä½¿ç”¨è£…é¥°ï¼Œä½ å¯ä»¥æ”¹å˜æ–‡æ¡£çš„æ˜¾ç¤ºæ–¹å¼ï¼Œä¾‹å¦‚é€šè¿‡é«˜äº®æ˜¾ç¤ºæ–‡æœ¬æˆ–æ·»åŠ è‡ªå®šä¹‰ HTML å…ƒç´ ã€‚</p><p>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»å‹çš„è£…é¥°ï¼š</p><ul><li>ä½¿ç”¨<a href="https://codemirror.net/docs/ref/#view.Decoration%5Emark" target="_blank" rel="noreferrer">Mark decorations</a>Â æ”¹å˜ç°æœ‰å…ƒç´ æ ·å¼ã€‚</li><li>ä½¿ç”¨<a href="https://codemirror.net/docs/ref/#view.Decoration%5Ewidget" target="_blank" rel="noreferrer">Widget decorations</a>Â åœ¨æ–‡æ¡£ä¸­æ’å…¥å°éƒ¨ä»¶å…ƒç´ ã€‚</li><li>ä½¿ç”¨<a href="https://codemirror.net/docs/ref/#view.Decoration%5Ereplace" target="_blank" rel="noreferrer">Replace decorations</a>Â éšè—å¯ä½¿ç”¨å…¶å®ƒå…ƒç´ æ›¿æ¢æ–‡æ¡£çš„éƒ¨åˆ†å†…å®¹ã€‚</li><li>ä½¿ç”¨<a href="https://codemirror.net/docs/ref/#view.Decoration%5Eline" target="_blank" rel="noreferrer">Line decorations</a>Â ä¸ºçº¿æ¡æ·»åŠ æ ·å¼ã€‚</li></ul><p>è¦ä½¿ç”¨è£…é¥°ï¼Œéœ€è¦åœ¨ç¼–è¾‘å™¨æ‰©å±•ä¸­åˆ›å»ºè£…é¥°ï¼Œå¹¶ç”±æ‰©å±•å°†å…¶æä¾›ç»™ç¼–è¾‘å™¨ã€‚å‘ç¼–è¾‘å™¨æä¾›è£…é¥°æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨<a href="./state-fields.html">çŠ¶æ€å­—æ®µ</a>ï¼Œå¦ä¸€ç§æ˜¯é—´æ¥ä½¿ç”¨<a href="./view-plugins.html">è§†å›¾æ’ä»¶</a>ã€‚</p><h2 id="åº”è¯¥ä½¿ç”¨è§†å›¾æ’ä»¶è¿˜æ˜¯çŠ¶æ€å­—æ®µ" tabindex="-1">åº”è¯¥ä½¿ç”¨è§†å›¾æ’ä»¶è¿˜æ˜¯çŠ¶æ€å­—æ®µï¼Ÿ <a class="header-anchor" href="#åº”è¯¥ä½¿ç”¨è§†å›¾æ’ä»¶è¿˜æ˜¯çŠ¶æ€å­—æ®µ" aria-label="Permalink to &quot;åº”è¯¥ä½¿ç”¨è§†å›¾æ’ä»¶è¿˜æ˜¯çŠ¶æ€å­—æ®µï¼Ÿ&quot;">â€‹</a></h2><p>è§†å›¾æ’ä»¶å’ŒçŠ¶æ€å­—æ®µéƒ½å¯ä»¥ä¸ºç¼–è¾‘å™¨æä¾›è£…é¥°ï¼Œä½†ä¸¤è€…æœ‰ä¸€äº›åŒºåˆ«ã€‚</p><ul><li>å¦‚æœå¯ä»¥æ ¹æ®<a href="./viewport.html">è§†çª—</a>ä¸­çš„å†…å®¹ç¡®å®šè£…é¥°ï¼Œåˆ™ä½¿ç”¨è§†å›¾æ’ä»¶ã€‚</li><li>å¦‚æœéœ€è¦ç®¡ç†è§†çª—ä»¥å¤–çš„è£…é¥°ï¼Œè¯·ä½¿ç”¨çŠ¶æ€å­—æ®µã€‚</li><li>å¦‚æœè¦æ›´æ”¹è§†çª—çš„å†…å®¹ï¼Œä¾‹å¦‚æ·»åŠ æ¢è¡Œç¬¦ï¼Œè¯·ä½¿ç”¨çŠ¶æ€å­—æ®µã€‚</li></ul><p>å¦‚æœæ‚¨å¯ä»¥ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•å®ç°æ‰©å±•ï¼Œé‚£ä¹ˆè§†å›¾æ’ä»¶é€šå¸¸ä¼šå¸¦æ¥æ›´å¥½çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³å®ç°ä¸€ä¸ªç¼–è¾‘å™¨æ‰©å±•ï¼Œç”¨äºæ£€æŸ¥æ–‡æ¡£çš„æ‹¼å†™ã€‚</p><p>ä¸€ç§æ–¹æ³•æ˜¯å°†æ•´ä¸ªæ–‡æ¡£ä¼ é€’ç»™å¤–éƒ¨æ‹¼å†™æ£€æŸ¥å™¨ï¼Œç„¶åè¿”å›æ‹¼å†™é”™è¯¯åˆ—è¡¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦å°†æ¯ä¸ªé”™è¯¯æ˜ å°„åˆ°ä¸€ä¸ªè£…é¥°ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªçŠ¶æ€å­—æ®µæ¥ç®¡ç†è£…é¥°ï¼Œè€Œä¸ç®¡å½“å‰è§†çª—ä¸­æœ‰ä»€ä¹ˆã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯åªå¯¹è§†çª—ä¸­å¯è§çš„å†…å®¹è¿›è¡Œæ‹¼å†™æ£€æŸ¥ã€‚æ‰©å±•ç¨‹åºéœ€è¦åœ¨ç”¨æˆ·æ»šåŠ¨æ–‡æ¡£æ—¶æŒç»­è¿è¡Œæ‹¼å†™æ£€æŸ¥ï¼Œä½†ä½ å¯ä»¥å¯¹æ•°ç™¾ä¸‡è¡Œæ–‡æœ¬çš„æ–‡æ¡£è¿›è¡Œæ‹¼å†™æ£€æŸ¥ã€‚</p><p><img src="'+l+`" alt="State field vs. view plugin"></p><h2 id="æä¾›è£…é¥°" tabindex="-1">æä¾›è£…é¥° <a class="header-anchor" href="#æä¾›è£…é¥°" aria-label="Permalink to &quot;æä¾›è£…é¥°&quot;">â€‹</a></h2><p>æƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨æƒ³åˆ›å»ºä¸€ä¸ªç¼–è¾‘å™¨æ‰©å±•ï¼Œç”¨è¡¨æƒ…ç¬¦å·æ›¿æ¢åˆ—è¡¨é¡¹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è§†å›¾æ’ä»¶æˆ–çŠ¶æ€å­—æ®µæ¥å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œä½†ä¸¤è€…ä¹‹é—´å­˜åœ¨ä¸€äº›å·®å¼‚ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œä½ å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨è¿™ä¸¤ç§æ‰©å±•æ¥å®ç°è¿™ä¸€åŠŸèƒ½ã€‚</p><p>ä¸¤ç§å®ç°æ–¹å¼çš„æ ¸å¿ƒé€»è¾‘ç›¸åŒï¼š</p><ol><li>ä½¿ç”¨ <a href="https://codemirror.net/docs/ref/#language.syntaxTree" target="_blank" rel="noreferrer">syntaxTree</a>Â  æŸ¥æ‰¾åˆ—è¡¨é¡¹ã€‚</li><li>å¯¹äºæ¯ä¸ªåˆ—è¡¨é¡¹ï¼Œç”¨ä¸€ä¸ªå°éƒ¨ä»¶æ›¿æ¢å‰å¯¼è¿å­—ç¬¦Â <code>-</code>Â ã€‚</li></ol><h3 id="widgets" tabindex="-1">Widgets <a class="header-anchor" href="#widgets" aria-label="Permalink to &quot;Widgets&quot;">â€‹</a></h3><p>Widgetæ˜¯å¯ä»¥æ·»åŠ åˆ°ç¼–è¾‘å™¨ä¸­çš„è‡ªå®šä¹‰ HTML å…ƒç´ ã€‚æ‚¨å¯ä»¥åœ¨æ–‡æ¡£çš„ç‰¹å®šä½ç½®æ’å…¥ Widgetï¼Œä¹Ÿå¯ä»¥ç”¨ Widget æ›¿æ¢æŸä¸ªå†…å®¹ã€‚</p><p>ä¸‹é¢çš„ç¤ºä¾‹å®šä¹‰äº†ä¸€ä¸ªè¿”å› HTML å…ƒç´ Â <code>&lt;span&gt;ğŸ‘‰&lt;/span&gt;</code>Â çš„ widgetã€‚ç¨åæ‚¨å°†ä½¿ç”¨è¯¥ widgetã€‚</p><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { EditorView, WidgetType } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@codemirror/view&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmojiWidget</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WidgetType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  toDOM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">view</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EditorView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> div</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;span&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    div.innerText </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ğŸ‘‰&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> div;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¦ä½¿ç”¨è¡¨æƒ…ç¬¦å·éƒ¨ä»¶æ›¿æ¢æ–‡æ¡£ä¸­çš„ä¸€ç³»åˆ—å†…å®¹ï¼Œè¯·ä½¿ç”¨Â <a href="https://codemirror.net/docs/ref/#view.Decoration%5Ereplace" target="_blank" rel="noreferrer">replace decoration</a> ã€‚</p><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> decoration</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Decoration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  widget: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmojiWidget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="çŠ¶æ€å­—æ®µ" tabindex="-1">çŠ¶æ€å­—æ®µ <a class="header-anchor" href="#çŠ¶æ€å­—æ®µ" aria-label="Permalink to &quot;çŠ¶æ€å­—æ®µ&quot;">â€‹</a></h3><p>ä»çŠ¶æ€æ ä¸­æä¾›è£…é¥°ï¼š</p><ol><li><p>ä½¿ç”¨Â <code>DecorationSet</code>Â ç±»å‹å®šä¹‰<a href="./state-fields.html">çŠ¶æ€å­—æ®µ</a>ã€‚</p></li><li><p>ä¸ºçŠ¶æ€å­—æ®µæ·»åŠ Â <code>provide</code>Â å±æ€§ã€‚</p><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(field: StateField</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DecorationSet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): Extension {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EditorView.decorations.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(field);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { syntaxTree } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@codemirror/language&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Extension,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  RangeSetBuilder,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  StateField,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Transaction,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@codemirror/state&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Decoration,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DecorationSet,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  EditorView,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  WidgetType,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@codemirror/view&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { EmojiWidget } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;emoji&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> emojiListField</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateField.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">define</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DecorationSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DecorationSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Decoration.none;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">oldState</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DecorationSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">transaction</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Transaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DecorationSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> builder</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RangeSetBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Decoration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    syntaxTree</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(transaction.state).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iterate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      enter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (node.type.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startsWith</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;list&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // Position of the &#39;-&#39; or the &#39;*&#39;.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> listCharFrom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node.from </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          builder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            listCharFrom,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            listCharFrom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Decoration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              widget: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmojiWidget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> builder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">finish</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">field</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StateField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DecorationSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Extension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EditorView.decorations.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(field);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="è§†å›¾æ’ä»¶" tabindex="-1">è§†å›¾æ’ä»¶ <a class="header-anchor" href="#è§†å›¾æ’ä»¶" aria-label="Permalink to &quot;è§†å›¾æ’ä»¶&quot;">â€‹</a></h3><p>ä½¿ç”¨è§†å›¾æ’ä»¶ç®¡ç†è£…é¥°ï¼š</p><ol><li>åˆ›å»ºè§†å›¾æ’ä»¶ã€‚</li><li>ä¸ºæ’ä»¶æ·»åŠ Â <code>DecorationSet</code>Â æˆå‘˜å±æ€§ã€‚</li><li>åˆå§‹åŒ–Â <code>constructor()</code>Â ä¸­çš„è£…é¥°ã€‚</li><li>åœ¨Â <code>update()</code>Â ä¸­é‡å»ºè£…é¥°ã€‚</li></ol><p>å¹¶éæ‰€æœ‰æ›´æ–°éƒ½éœ€è¦é‡å»ºè£…é¥°ã€‚ä¸‹é¢çš„ç¤ºä¾‹åªåœ¨åº•å±‚æ–‡æ¡£æˆ–è§†çª—å‘ç”Ÿå˜åŒ–æ—¶é‡å»ºè£…é¥°ã€‚</p><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { syntaxTree } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@codemirror/language&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { RangeSetBuilder } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@codemirror/state&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Decoration,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DecorationSet,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  EditorView,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  PluginSpec,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  PluginValue,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ViewPlugin,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ViewUpdate,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  WidgetType,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@codemirror/view&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { EmojiWidget } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;emoji&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmojiListPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PluginValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  decorations</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DecorationSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">view</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EditorView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.decorations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">buildDecorations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">update</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ViewUpdate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (update.docChanged </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> update.viewportChanged) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.decorations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">buildDecorations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(update.view);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  destroy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  buildDecorations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">view</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EditorView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DecorationSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> builder</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RangeSetBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Decoration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { from, to } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">of</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> view.visibleRanges) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      syntaxTree</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view.state).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iterate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        from,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        to,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        enter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (node.type.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startsWith</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;list&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Position of the &#39;-&#39; or the &#39;*&#39;.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> listCharFrom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node.from </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            builder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              listCharFrom,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              listCharFrom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              Decoration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                widget: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmojiWidget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> builder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">finish</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pluginSpec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PluginSpec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EmojiListPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  decorations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmojiListPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value.decorations,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> emojiListPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ViewPlugin.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fromClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  EmojiListPlugin,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pluginSpec</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p><code>buildDecorations()</code>Â æ˜¯ä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼Œå¯æ ¹æ®ç¼–è¾‘å™¨è§†å›¾åˆ›å»ºä¸€å¥—å®Œæ•´çš„è£…é¥°ã€‚</p><p>è¯·æ³¨æ„Â <code>ViewPlugin.fromClass()</code>Â å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚Â <code>PluginSpec</code>Â ä¸­çš„Â <code>decorations</code>Â å±æ€§æŒ‡å®šäº†è§†å›¾æ’ä»¶å‘ç¼–è¾‘å™¨æä¾›è£…é¥°çš„æ–¹å¼ã€‚</p><p>ç”±äºè§†å›¾æ’ä»¶çŸ¥é“ç”¨æˆ·å¯ä»¥çœ‹åˆ°ä»€ä¹ˆï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨Â <code>view.visibleRanges</code>Â æ¥é™åˆ¶è®¿é—®è¯­æ³•æ ‘çš„å“ªäº›éƒ¨åˆ†ã€‚</p>`,42),h=[e];function t(k,r,E,d,g,c){return a(),i("div",null,h)}const b=s(p,[["render",t]]);export{y as __pageData,b as default};
